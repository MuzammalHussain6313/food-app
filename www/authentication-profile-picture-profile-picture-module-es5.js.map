{"version":3,"sources":["./src/app/authentication/profile-picture/profile-picture.page.html","./src/app/authentication/profile-picture/profile-picture.module.ts","./src/app/authentication/profile-picture/profile-picture.page.scss","./src/app/authentication/profile-picture/profile-picture.page.ts"],"names":[],"mappings":"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","file":"authentication-profile-picture-profile-picture-module-es5.js","sourcesContent":["module.exports = \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons>\\n      <ion-back-button></ion-back-button>\\n    </ion-buttons>\\n    <ion-title>\\n      Upload\\n    </ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content class=\\\"ion-padding\\\">\\n  <ion-item>\\n    <ion-label>\\n      <ion-row>\\n        <ion-col size=\\\"6\\\">\\n          <ion-button color=\\\"danger\\\" type=\\\"button\\\" expand=\\\"full\\\" shape=\\\"round\\\" size=\\\"large\\\" (click)=\\\"takePhoto()\\\">\\n            <ion-icon name=\\\"camera\\\"></ion-icon>\\n          </ion-button>\\n        </ion-col>\\n        <ion-col size=\\\"6\\\">\\n          <ion-button color=\\\"secondary\\\" type=\\\"button\\\" expand=\\\"full\\\" shape=\\\"round\\\" size=\\\"large\\\" (click)=\\\"selectPhoto()\\\">\\n            <ion-icon name=\\\"image\\\"></ion-icon>\\n          </ion-button>\\n        </ion-col>\\n      </ion-row>\\n    </ion-label>\\n  </ion-item>\\n  <ion-item *ngIf=\\\"error\\\">\\n    <ion-label>\\n      <strong>{{error}}</strong>\\n    </ion-label>\\n  </ion-item>\\n  <ion-item>\\n    <ion-label>\\n      <img *ngIf=\\\"myPhoto\\\" [src]=\\\"myPhoto\\\"/>\\n    </ion-label>\\n  </ion-item>\\n</ion-content>\\n\"","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ProfilePicturePage } from './profile-picture.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ProfilePicturePage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [ProfilePicturePage]\n})\nexport class ProfilePicturePageModule {}\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2F1dGhlbnRpY2F0aW9uL3Byb2ZpbGUtcGljdHVyZS9wcm9maWxlLXBpY3R1cmUucGFnZS5zY3NzIn0= */\"","import {ChangeDetectorRef, Component, OnInit} from '@angular/core';\nimport {HttpClient} from '@angular/common/http';\nimport {LoadingController, ToastController} from '@ionic/angular';\nimport {catchError, finalize} from 'rxjs/operators';\nimport {throwError} from 'rxjs';\nimport {ListService} from '../../list.service';\n\n@Component({\n  selector: 'app-profile-picture',\n  templateUrl: './profile-picture.page.html',\n  styleUrls: ['./profile-picture.page.scss']\n})\nexport class ProfilePicturePage implements OnInit {\n\n  public myPhoto: any;\n  public error: string;\n  private loading: any;\n\n  constructor(private readonly http: HttpClient,\n              private readonly loadingCtrl: LoadingController,\n              private readonly toastCtrl: ToastController,\n              private service: ListService,\n              private readonly changeDetectorRef: ChangeDetectorRef) {\n  }\n\n  takePhoto() {\n    const camera: any = navigator['camera'];\n    camera.getPicture(imageData => {\n      this.myPhoto = this.convertFileSrc(imageData);\n      this.changeDetectorRef.detectChanges();\n      this.changeDetectorRef.markForCheck();\n      this.uploadPhoto(imageData);\n    }, error => this.error = JSON.stringify(error), {\n      quality: 100,\n      destinationType: camera.DestinationType.FILE_URI,\n      sourceType: camera.PictureSourceType.CAMERA,\n      encodingType: camera.EncodingType.JPEG\n    });\n  }\n\n  selectPhoto(): void {\n    const camera: any = navigator['camera'];\n    camera.getPicture(imageData => {\n      this.myPhoto = this.convertFileSrc(imageData);\n      this.uploadPhoto(imageData);\n    }, error => this.error = JSON.stringify(error), {\n      sourceType: camera.PictureSourceType.PHOTOLIBRARY,\n      destinationType: camera.DestinationType.FILE_URI,\n      quality: 100,\n      encodingType: camera.EncodingType.JPEG,\n    });\n  }\n\n  private convertFileSrc(url: string): string {\n    if (!url) {\n      return url;\n    }\n    if (url.startsWith('/')) {\n      return window['WEBVIEW_SERVER_URL'] + '/_app_file_' + url;\n    }\n    if (url.startsWith('file://')) {\n      return window['WEBVIEW_SERVER_URL'] + url.replace('file://', '/_app_file_');\n    }\n    if (url.startsWith('content://')) {\n      return window['WEBVIEW_SERVER_URL'] + url.replace('content:/', '/_app_content_');\n    }\n    return url;\n  }\n\n  private async uploadPhoto(imageFileUri: any) {\n    this.error = null;\n    this.loading = await this.loadingCtrl.create({\n      message: 'Uploading...'\n    });\n\n    this.loading.present();\n\n    window['resolveLocalFileSystemURL'](imageFileUri,\n        entry => {\n          entry['file'](file => this.readFile(file));\n        });\n  }\n\n  private readFile(file: any) {\n    const reader = new FileReader();\n    reader.onloadend = () => {\n      const formData = new FormData();\n      const imgBlob = new Blob([reader.result], {type: file.type});\n      formData.append('file', imgBlob, file.name);\n      this.postData(formData);\n    };\n    reader.readAsArrayBuffer(file);\n  }\n\n  private postData(formData: FormData) {\n    this.http.post<boolean>(`${this.service.homeUrl}/upload`, formData)\n        .pipe(\n            catchError(e => this.handleError(e)),\n            finalize(() => this.loading.dismiss())\n        )\n        .subscribe(ok => this.showToast(ok));\n  }\n\n  private async showToast(ok: boolean | {}) {\n    if (ok === true) {\n      const toast = await this.toastCtrl.create({\n        message: 'Upload successful',\n        duration: 3000,\n        position: 'top'\n      });\n      toast.present();\n    } else {\n      const toast = await this.toastCtrl.create({\n        message: 'Upload failed',\n        duration: 3000,\n        position: 'top'\n      });\n      toast.present();\n    }\n  }\n\n  private handleError(error: any) {\n    const errMsg = error.message ? error.message : error.toString();\n    this.error = errMsg;\n    this.changeDetectorRef.detectChanges();\n    return throwError(errMsg);\n  }\n\n  ngOnInit(): void {\n  }\n}\n"],"sourceRoot":""}